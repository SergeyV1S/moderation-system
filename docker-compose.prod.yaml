services:
  server:
    image: ${SERVER_DOCKER_IMAGE}
    environment:
      CLIENT_BASE_URL: ${CLIENT_BASE_URL}
      PORT: ${API_PORT}
    ports:
      - "${API_PORT}:${API_PORT}"
    deploy:
      resources:
        limits:
          cpus: "1"
          memory: 512MB

  client:
    image: ${CLIENT_DOCKER_IMAGE}
    environment:
      API_URL: ${API_URL}
      PORT: ${CLIENT_PORT}
    ports:
      - "${CLIENT_PORT}:80"
    depends_on:
      server:
        condition: service_healthy
    deploy:
      resources:
        limits:
          cpus: "1"
          memory: 512MB
